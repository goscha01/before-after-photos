<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="theme-color" content="#667eea" />
    <meta name="description" content="Mobile-first cleaning photo documentation app" />

    <!-- PWA Meta Tags -->
    <link rel="manifest" href="/manifest.json" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />

    <!-- Prevent zoom on input fields -->
    <meta name="format-detection" content="telephone=no" />

    <!-- Status bar styling for iOS -->
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="Cleaning App" />
    
    <!-- Additional iOS compatibility -->
    <meta name="apple-touch-fullscreen" content="yes" />
    <meta name="apple-mobile-web-app-orientations" content="portrait" />

    <title>Cleaning Photo App</title>

    <style>
      /* Prevent flash of unstyled content */
      body {
        margin: 0;
        padding: 0;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
        background-color: #f8fafc;
        color: #1e293b;
        overscroll-behavior: none;
      }

      /* Loading spinner */
      .loading-container {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: #f8fafc;
        z-index: 9999;
      }

      .loading-spinner {
        width: 40px;
        height: 40px;
        border: 3px solid #e2e8f0;
        border-top: 3px solid #667eea;
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }

      /* Hide loading once React loads */
      #root:not(:empty) + .loading-container {
        display: none;
      }

      /* Debug info */
      .debug-info {
        position: fixed;
        top: 10px;
        left: 10px;
        background: rgba(0, 0, 0, 0.8);
        color: white;
        padding: 10px;
        border-radius: 5px;
        font-size: 12px;
        z-index: 10000;
        max-width: 300px;
      }
    </style>
  <link rel="manifest" href="/manifest.webmanifest"><script id="vite-plugin-pwa:register-sw" src="/registerSW.js"></script></head>
  <body>
    <div id="root"></div>
    <div class="loading-container">
      <div class="loading-spinner"></div>
    </div>
    
    <!-- Debug info (hidden by default) -->
    <div class="debug-info" id="debug-info" style="display: none;">
      <div>üöÄ HTML Loaded</div>
      <div>üì± User Agent: <span id="user-agent">Loading...</span></div>
      <div>üåê Location: <span id="location">Loading...</span></div>
      <div>‚è∞ Time: <span id="time">Loading...</span></div>
    </div>
    
    <script>
      // Basic debug info
      console.log('üöÄ Debug: HTML loaded');
      console.log('üöÄ Debug: User Agent:', navigator.userAgent);
      console.log('üöÄ Debug: Location:', window.location.href);
      
      // Update debug info
      document.getElementById('user-agent').textContent = navigator.userAgent.substring(0, 50) + '...';
      document.getElementById('location').textContent = window.location.href;
      document.getElementById('time').textContent = new Date().toLocaleTimeString();
      
      // Check if we're on iOS
      const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
      console.log('üöÄ Debug: Is iOS:', isIOS);
      
      if (isIOS) {
        document.getElementById('debug-info').innerHTML += '<div style="color: #ff6b6b;">üçé iOS Detected</div>';
      }
      
      // Check if React loads
      let reactLoadTimer = setTimeout(() => {
        console.log('‚ùå Debug: React failed to load within 10 seconds');
        document.getElementById('debug-info').innerHTML += '<div style="color: #ff6b6b;">‚ùå React Failed to Load</div>';
      }, 10000);
      
      // Clear timer when React loads
      window.addEventListener('load', () => {
        clearTimeout(reactLoadTimer);
        console.log('‚úÖ Debug: Page fully loaded');
      });
      
      // Check for React errors
      window.addEventListener('error', (e) => {
        console.log('‚ùå Debug: JavaScript error:', e.error);
        document.getElementById('debug-info').innerHTML += '<div style="color: #ff6b6b;">‚ùå JS Error: ' + e.error.message + '</div>';
      });
      
      // Check for unhandled promise rejections
      window.addEventListener('unhandledrejection', (e) => {
        console.log('‚ùå Debug: Unhandled promise rejection:', e.reason);
        document.getElementById('debug-info').innerHTML += '<div style="color: #ff6b6b;">‚ùå Promise Error: ' + e.reason + '</div>';
      });
      
      // Monitor script loading
      const scripts = document.querySelectorAll('script[type="module"]');
      scripts.forEach((script, index) => {
        script.addEventListener('load', () => {
          console.log('‚úÖ Debug: Script ' + index + ' loaded successfully');
          document.getElementById('debug-info').innerHTML += '<div style="color: green;">‚úÖ Script ' + index + ' loaded</div>';
        });
        script.addEventListener('error', (e) => {
          console.log('‚ùå Debug: Script ' + index + ' failed to load:', e);
          document.getElementById('debug-info').innerHTML += '<div style="color: red;">‚ùå Script ' + index + ' failed: ' + e.message + '</div>';
        });
      });
      
      // Check if main.jsx loads
      console.log('üöÄ Debug: About to load main.jsx');
    </script>
    
    <!-- Simple JavaScript test -->
    <script>
      console.log('üß™ Debug: Testing basic JavaScript...');
      
      // Test if we can create DOM elements
      try {
        const testDiv = document.createElement('div');
        testDiv.innerHTML = '<div style="color: green;">‚úÖ Basic JavaScript Works!</div>';
        document.getElementById('debug-info').appendChild(testDiv);
        console.log('‚úÖ Debug: Basic JavaScript works');
      } catch (e) {
        console.log('‚ùå Debug: Basic JavaScript failed:', e);
      }
      
      // Test if we can fetch (for checking if the app files exist)
      fetch('/src/main.jsx')
        .then(response => {
          console.log('‚úÖ Debug: main.jsx file exists, status:', response.status);
          if (response.status === 200) {
            document.getElementById('debug-info').innerHTML += '<div style="color: green;">‚úÖ main.jsx file exists</div>';
          } else {
            document.getElementById('debug-info').innerHTML += '<div style="color: red;">‚ùå main.jsx file not found (status: ' + response.status + ')</div>';
          }
        })
        .catch(error => {
          console.log('‚ùå Debug: Cannot fetch main.jsx:', error);
          document.getElementById('debug-info').innerHTML += '<div style="color: red;">‚ùå Cannot fetch main.jsx: ' + error.message + '</div>';
        });
    </script>
    
    <!-- Try a very simple inline test first -->
    <script>
      console.log('üß™ Debug: Inline script starting...');
      try {
        const root = document.getElementById('root');
        if (root) {
          root.innerHTML = '<div style="padding: 20px; color: green; font-family: Arial, sans-serif;"><h1>‚úÖ Inline Script Works!</h1><p>JavaScript is executing on iPhone!</p></div>';
          console.log('‚úÖ Debug: Inline script successful');
        } else {
          console.log('‚ùå Debug: Root element not found in inline script');
        }
      } catch (e) {
        console.log('‚ùå Debug: Inline script error:', e);
      }
    </script>
    
    <!-- Try regular script (not module) -->
    <script>
      console.log('üß™ Debug: Testing regular script execution...');
      
      try {
        const rootElement = document.getElementById('root');
        if (rootElement) {
          rootElement.innerHTML = '<div style="padding: 20px; color: green; font-family: Arial, sans-serif;"><h1>‚úÖ Regular Script Works!</h1><p>This proves regular JavaScript works on iOS Safari.</p><p>Now loading bundled React app...</p></div>';
          console.log('‚úÖ Debug: Regular script execution successful');
        }
      } catch (error) {
        console.log('‚ùå Debug: Regular script failed:', error);
      }
    </script>
    
    <!-- iOS Safari Compatible Cleaning Photo App -->
    <script>
      console.log('üöÄ Debug: Loading iOS Safari compatible version...');
      
      // Simple photo documentation app
      class CleaningPhotoApp {
        constructor() {
          this.photos = [];
          this.currentRoom = 'kitchen';
          this.currentTab = 'photo';
          this.init();
        }
        
        init() {
          const rootElement = document.getElementById('root');
          if (rootElement) {
            rootElement.innerHTML = this.getAppHTML();
            this.attachEventListeners();
            this.loadPhotos();
          }
        }
        
        getAppHTML() {
          return `
            <div style="min-height: 100vh; background: #f8fafc; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">
              <!-- Header -->
              <div style="background: #667eea; color: white; padding: 20px; text-align: center;">
                <h1 style="margin: 0; font-size: 24px;">üßπ Cleaning Photo App</h1>
                <p style="margin: 8px 0 0 0; opacity: 0.9;">iOS Safari Compatible Version</p>
              </div>
              
              <!-- Main Content -->
              <div style="padding: 20px; max-width: 500px; margin: 0 auto;">
                
                <!-- Room Selector -->
                <div style="background: white; border-radius: 12px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                  <h3 style="margin: 0 0 15px 0; color: #1e293b;">Select Room</h3>
                  <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                    ${this.getRoomButtons()}
                  </div>
                </div>
                
                
                <!-- Camera Section -->
                <div style="background: white; border-radius: 12px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                  <h3 style="margin: 0 0 15px 0; color: #1e293b;">Take Photo</h3>
                  <div style="text-align: center;">
                    <button id="camera-btn" style="background: #10b981; color: white; border: none; padding: 15px 30px; border-radius: 8px; font-size: 18px; cursor: pointer;">
                      üì∑ Open Camera
                    </button>
                    <p style="color: #64748b; font-size: 14px; margin: 10px 0 0 0;">
                      Note: Camera access requires HTTPS and user permission
                    </p>
                  </div>
                </div>
                
                <!-- Photos Gallery -->
                <div style="background: white; border-radius: 12px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                  <div style="margin-bottom: 15px;">
                    <h3 style="margin: 0 0 5px 0; color: #1e293b;">${this.currentRoom.charAt(0).toUpperCase() + this.currentRoom.slice(1).replace('-', ' ')} Gallery</h3>
                    <div style="font-size: 14px; color: #64748b; font-weight: 500;">Album: ${this.currentRoom.charAt(0).toUpperCase() + this.currentRoom.slice(1).replace('-', ' ')} Cleaning Documentation</div>
                  </div>
                  
                  <!-- Photo tabs -->
                  <div style="display: flex; gap: 5px; margin-bottom: 15px; background: #f1f5f9; padding: 4px; border-radius: 8px;">
                    <button id="tab-photo" class="photo-tab" data-tab="photo" style="flex: 1; padding: 8px 12px; border: none; border-radius: 6px; font-size: 14px; cursor: pointer; background: ${this.currentTab === 'photo' ? '#667eea' : 'transparent'}; color: ${this.currentTab === 'photo' ? 'white' : '#64748b'}; transition: all 0.2s;">
                      Photo (${this.getRoomPhotosByType('photo').length})
                    </button>
                    <button id="tab-combined" class="photo-tab" data-tab="combined" style="flex: 1; padding: 8px 12px; border: none; border-radius: 6px; font-size: 14px; cursor: pointer; background: ${this.currentTab === 'combined' ? '#667eea' : 'transparent'}; color: ${this.currentTab === 'combined' ? 'white' : '#64748b'}; transition: all 0.2s;">
                      Combined (${this.getRoomPhotosByType('combined').length})
                    </button>
                    <button id="tab-all" class="photo-tab" data-tab="all" style="flex: 1; padding: 8px 12px; border: none; border-radius: 6px; font-size: 14px; cursor: pointer; background: ${this.currentTab === 'all' ? '#667eea' : 'transparent'}; color: ${this.currentTab === 'all' ? 'white' : '#64748b'}; transition: all 0.2s;">
                      All (${this.getRoomPhotosByType('all').length})
                    </button>
                  </div>
                  
                  <div id="photos-container" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                    ${this.getPhotosHTML()}
                  </div>
                </div>
                
                <!-- Status -->
                <div style="background: #e0f2fe; border-radius: 12px; padding: 15px; text-align: center;">
                  <p style="margin: 0; color: #0369a1; font-size: 14px;">
                    üì± This version works on iOS Safari without ES6 modules
                  </p>
                </div>
                
              </div>
            </div>
          `;
        }
        
        getRoomButtons() {
          const rooms = ['kitchen', 'bathroom', 'bedroom', 'living-room', 'dining-room', 'office'];
          return rooms.map(room => `
            <button class="room-btn" data-room="${room}" 
                    style="padding: 10px; border: 1px solid #e2e8f0; background: ${this.currentRoom === room ? '#667eea' : 'white'}; color: ${this.currentRoom === room ? 'white' : '#64748b'}; border-radius: 6px; font-size: 14px;">
              ${room.charAt(0).toUpperCase() + room.slice(1).replace('-', ' ')}
            </button>
          `).join('');
        }
        
        getPhotosHTML() {
          const filteredPhotos = this.getRoomFilteredPhotos();
          if (filteredPhotos.length === 0) {
            return '<p style="grid-column: 1 / -1; text-align: center; color: #64748b; font-style: italic;">No photos in this category</p>';
          }
          
          // Sort photos alphabetically by name (descending order)
          const sortedPhotos = filteredPhotos.sort((a, b) => {
            const nameA = a.name || `${a.room}_${a.mode}_${a.timestamp}`;
            const nameB = b.name || `${b.room}_${b.mode}_${b.timestamp}`;
            return nameB.localeCompare(nameA);
          });
          
          return sortedPhotos.map((photo, index) => {
            const photoName = photo.name || `${photo.room}_${photo.mode}_${photo.timestamp}`;
            const displayName = photoName.replace(/_/g, ' ').replace(/\d{4}-\d{2}-\d{2}T\d{2}-\d{2}-\d{2}/, '');
            
            return `
              <div class="photo-item" data-photo-index="${this.photos.indexOf(photo)}" style="border: 1px solid #e2e8f0; border-radius: 8px; overflow: hidden; position: relative; transition: transform 0.2s;">
                <img src="${photo.dataUrl}" style="width: 100%; height: 120px; object-fit: cover; cursor: pointer;" />
                <div style="padding: 8px; font-size: 11px; color: #64748b;">
                  <div style="font-weight: bold; margin-bottom: 2px;">${displayName}</div>
                  <div style="font-size: 10px; opacity: 0.8;">${new Date(photo.timestamp).toLocaleString()}</div>
                </div>
                <!-- Delete button -->
                <button class="delete-photo-btn" data-photo-index="${this.photos.indexOf(photo)}" style="position: absolute; top: 5px; right: 5px; background: rgba(239,68,68,0.9); color: white; border: none; padding: 5px; border-radius: 50%; font-size: 12px; cursor: pointer; width: 25px; height: 25px; display: flex; align-items: center; justify-content: center;">
                  üóëÔ∏è
                </button>
              </div>
            `;
          }).join('');
        }
        
        getRoomPhotosByType(type) {
          const roomPhotos = this.photos.filter(photo => photo.room === this.currentRoom);
          if (type === 'photo') {
            return roomPhotos.filter(photo => photo.mode === 'before' || photo.mode === 'after');
          } else if (type === 'combined') {
            return roomPhotos.filter(photo => photo.mode === 'mix');
          } else if (type === 'all') {
            return roomPhotos.filter(photo => photo.mode === 'archived');
          }
          return roomPhotos;
        }
        
        getRoomFilteredPhotos() {
          const activeTab = this.currentTab || 'photo';
          return this.getRoomPhotosByType(activeTab);
        }
        
        attachEventListeners() {
          // Room selection
          document.querySelectorAll('.room-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
              this.currentRoom = e.target.dataset.room;
              this.init();
            });
          });
          
          
          // Camera
          document.getElementById('camera-btn').addEventListener('click', () => {
            this.openCamera();
          });
          
          // Photo tabs
          document.querySelectorAll('.photo-tab').forEach(tab => {
            tab.addEventListener('click', (e) => {
              this.currentTab = e.target.dataset.tab;
              this.updateTabs();
              this.init();
            });
          });
          
          // Photo click to view fullscreen and delete functionality
          setTimeout(() => {
            document.querySelectorAll('.photo-item').forEach(item => {
              // Photo click to view fullscreen
              item.addEventListener('click', (e) => {
                // Don't trigger if clicking delete button
                if (e.target.classList.contains('delete-photo-btn')) return;
                
                const photoIndex = parseInt(e.currentTarget.dataset.photoIndex);
                this.showPhotoFullscreen(this.photos[photoIndex]);
              });
              
              // Add hover effect
              item.addEventListener('mouseenter', (e) => {
                e.currentTarget.style.transform = 'scale(1.02)';
              });
              item.addEventListener('mouseleave', (e) => {
                e.currentTarget.style.transform = 'scale(1)';
              });
            });
            
            // Delete button functionality
            document.querySelectorAll('.delete-photo-btn').forEach(btn => {
              btn.addEventListener('click', (e) => {
                e.stopPropagation(); // Prevent photo click
                const photoIndex = parseInt(e.currentTarget.dataset.photoIndex);
                this.deletePhoto(photoIndex);
              });
            });
          }, 100);
        }
        
        
        updateTabs() {
          document.querySelectorAll('.photo-tab').forEach(tab => {
            const tabType = tab.dataset.tab;
            if (tabType === this.currentTab) {
              tab.style.background = '#667eea';
              tab.style.color = 'white';
            } else {
              tab.style.background = 'transparent';
              tab.style.color = '#64748b';
            }
          });
        }
        
        deletePhoto(photoIndex) {
          if (photoIndex >= 0 && photoIndex < this.photos.length) {
            const photo = this.photos[photoIndex];
            const photoType = photo.mode === 'mix' ? 'combined before/after' : photo.mode;
            
            if (confirm(`Are you sure you want to delete this ${photoType} photo from ${photo.room}?`)) {
              this.photos.splice(photoIndex, 1);
              this.savePhotos();
              this.init(); // Refresh the gallery
            }
          }
        }
        
        async showPhotoFullscreen(photo) {
          const modal = document.createElement('div');
          modal.style.cssText = `
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; 
            background: rgba(0,0,0,0.95); z-index: 2000; display: flex; 
            flex-direction: column;
          `;
          
          if (photo.mode === 'before') {
            // Split screen: before photo on top, camera on bottom
            modal.innerHTML = `
              <div style="position: relative; width: 100vw; height: 100vh; display: flex; flex-direction: column;">
                <!-- Before photo (top half) -->
                <div style="position: relative; width: 100%; height: 50%; background: black;">
                  <img src="${photo.dataUrl}" style="width: 100%; height: 100%; object-fit: cover;" />
                  
                  <!-- Photo info overlay -->
                  <div style="position: absolute; bottom: 0; left: 0; right: 0; background: linear-gradient(transparent, rgba(0,0,0,0.8)); padding: 20px; text-align: center; color: white;">
                    <div style="font-size: 18px; font-weight: bold; margin-bottom: 5px;">
                      ${photo.room.charAt(0).toUpperCase() + photo.room.slice(1).replace('-', ' ')} - BEFORE
                    </div>
                    <div style="font-size: 14px; opacity: 0.9;">
                      ${new Date(photo.timestamp).toLocaleString()}
                    </div>
                  </div>
                </div>
                
                <!-- Camera (bottom half) -->
                <div id="camera-container" style="position: relative; width: 100%; height: 50%; background: black;">
                  <video id="comparison-camera" autoplay muted playsinline style="width: 100%; height: 100%; object-fit: cover;"></video>
                  
                  <!-- Photo frame overlay for camera -->
                  <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; pointer-events: none; display: flex; align-items: center; justify-content: center;">
                    <div style="width: 90%; height: 90%; border: 3px solid rgba(255,255,255,0.8); border-radius: 8px; box-shadow: 0 0 20px rgba(0,0,0,0.5);"></div>
                  </div>
                  
                  <!-- Camera controls -->
                  <div style="position: absolute; bottom: 20px; left: 0; right: 0; display: flex; justify-content: center; align-items: center; gap: 20px;">
                    <!-- Camera switch button -->
                    <button id="comparison-switch-camera-btn" style="background: rgba(0,0,0,0.6); color: white; border: none; padding: 12px; border-radius: 50%; font-size: 18px; cursor: pointer; backdrop-filter: blur(10px);">
                      üîÑ
                    </button>
                    
                    <!-- Capture button -->
                    <button id="comparison-capture-btn" style="background: #10b981; color: white; border: none; padding: 18px; border-radius: 50%; font-size: 22px; cursor: pointer; box-shadow: 0 4px 12px rgba(0,0,0,0.3);">
                      üì∏
                    </button>
                  </div>
                </div>
                
                <!-- Close button -->
                <button id="close-comparison-btn" style="position: absolute; top: 20px; right: 20px; background: rgba(0,0,0,0.7); color: white; border: none; padding: 15px; border-radius: 50%; font-size: 24px; cursor: pointer; backdrop-filter: blur(10px);">
                  ‚ùå
                </button>
              </div>
            `;
            
            document.body.appendChild(modal);
            
            // Initialize camera for comparison
            try {
              let stream;
              try {
                stream = await navigator.mediaDevices.getUserMedia({ 
                  video: { facingMode: 'environment' } // Default to back camera
                });
              } catch (backCameraError) {
                console.log('Back camera not available, trying any camera:', backCameraError);
                stream = await navigator.mediaDevices.getUserMedia({ video: true });
              }
              
              const video = document.getElementById('comparison-camera');
              video.srcObject = stream;
              
              let currentFacingMode = 'environment';
              
              // Capture button
              document.getElementById('comparison-capture-btn').addEventListener('click', () => {
                this.captureComparisonPhoto(video, stream, photo);
              });
              
              // Camera switch button
              document.getElementById('comparison-switch-camera-btn').addEventListener('click', async () => {
                try {
                  stream.getTracks().forEach(track => track.stop());
                  currentFacingMode = currentFacingMode === 'user' ? 'environment' : 'user';
                  const newStream = await navigator.mediaDevices.getUserMedia({ 
                    video: { facingMode: currentFacingMode }
                  });
                  video.srcObject = newStream;
                  stream = newStream;
                } catch (error) {
                  console.log('Camera switch failed:', error);
                  alert('Camera switch failed: ' + error.message);
                }
              });
              
              // Close button
              document.getElementById('close-comparison-btn').addEventListener('click', () => {
                stream.getTracks().forEach(track => track.stop());
                document.body.removeChild(modal);
              });
              
            } catch (error) {
              alert('Camera access denied or failed: ' + error.message);
              document.body.removeChild(modal);
            }
            
          } else {
            // Regular fullscreen for after photos
            modal.innerHTML = `
              <div style="position: relative; width: 100vw; height: 100vh; display: flex; align-items: center; justify-content: center;">
                <img src="${photo.dataUrl}" style="width: 100vw; height: 100vh; object-fit: cover;" />
                
                <!-- Photo info overlay -->
                <div style="position: absolute; bottom: 0; left: 0; right: 0; background: linear-gradient(transparent, rgba(0,0,0,0.8)); padding: 40px 20px 20px; text-align: center; color: white;">
                  <div style="font-size: 20px; font-weight: bold; margin-bottom: 8px;">
                    ${photo.room.charAt(0).toUpperCase() + photo.room.slice(1).replace('-', ' ')} - ${photo.mode.charAt(0).toUpperCase() + photo.mode.slice(1)}
                  </div>
                  <div style="font-size: 16px; opacity: 0.9;">
                    ${new Date(photo.timestamp).toLocaleString()}
                  </div>
                </div>
                
                <!-- Close button -->
                <button id="close-photo-btn" style="position: absolute; top: 20px; right: 20px; background: rgba(0,0,0,0.7); color: white; border: none; padding: 15px; border-radius: 50%; font-size: 24px; cursor: pointer; backdrop-filter: blur(10px);">
                  ‚ùå
                </button>
              </div>
            `;
            
            document.body.appendChild(modal);
            
            document.getElementById('close-photo-btn').addEventListener('click', () => {
              document.body.removeChild(modal);
            });
            
            // Close on background click
            modal.addEventListener('click', (e) => {
              if (e.target === modal) {
                document.body.removeChild(modal);
              }
            });
          }
        }
        
        captureComparisonPhoto(video, stream, beforePhoto) {
          const canvas = document.createElement('canvas');
          const ctx = canvas.getContext('2d');
          
          canvas.width = video.videoWidth;
          canvas.height = video.videoHeight;
          
          ctx.drawImage(video, 0, 0);
          
          const dataUrl = canvas.toDataURL('image/jpeg', 0.8);
          
          // Stop camera stream
          stream.getTracks().forEach(track => track.stop());
          
          // Show preview with retake/save options
          this.showPhotoPreview(dataUrl, beforePhoto, stream);
        }
        
        showPhotoPreview(afterPhotoDataUrl, beforePhoto, originalStream) {
          const modal = document.querySelector('[style*="position: fixed"]');
          if (modal) {
            modal.innerHTML = `
              <div style="position: relative; width: 100vw; height: 100vh; display: flex; flex-direction: column;">
                <!-- Before photo (top half) -->
                <div style="position: relative; width: 100%; height: 50%; background: black;">
                  <img src="${beforePhoto.dataUrl}" style="width: 100%; height: 100%; object-fit: cover;" />
                  
                  <!-- Photo info overlay -->
                  <div style="position: absolute; bottom: 0; left: 0; right: 0; background: linear-gradient(transparent, rgba(0,0,0,0.8)); padding: 20px; text-align: center; color: white;">
                    <div style="font-size: 18px; font-weight: bold; margin-bottom: 5px;">
                      ${beforePhoto.room.charAt(0).toUpperCase() + beforePhoto.room.slice(1).replace('-', ' ')} - BEFORE
                    </div>
                    <div style="font-size: 14px; opacity: 0.9;">
                      ${new Date(beforePhoto.timestamp).toLocaleString()}
                    </div>
                  </div>
                </div>
                
                <!-- After photo preview (bottom half) -->
                <div style="position: relative; width: 100%; height: 50%; background: black;">
                  <img src="${afterPhotoDataUrl}" style="width: 100%; height: 100%; object-fit: cover;" />
                  
                  <!-- Photo info overlay -->
                  <div style="position: absolute; bottom: 0; left: 0; right: 0; background: linear-gradient(transparent, rgba(0,0,0,0.8)); padding: 20px; text-align: center; color: white;">
                    <div style="font-size: 18px; font-weight: bold; margin-bottom: 5px;">
                      ${beforePhoto.room.charAt(0).toUpperCase() + beforePhoto.room.slice(1).replace('-', ' ')} - AFTER
                    </div>
                    <div style="font-size: 14px; opacity: 0.9;">
                      ${new Date().toLocaleString()}
                    </div>
                  </div>
                  
                  <!-- Action buttons -->
                  <div style="position: absolute; bottom: 20px; left: 0; right: 0; display: flex; justify-content: center; align-items: center; gap: 20px;">
                    <!-- Retake button -->
                    <button id="retake-btn" style="background: rgba(239,68,68,0.8); color: white; border: none; padding: 15px 25px; border-radius: 25px; font-size: 16px; cursor: pointer; backdrop-filter: blur(10px);">
                      üîÑ Retake
                    </button>
                    
                    <!-- Save button -->
                    <button id="save-btn" style="background: rgba(16,185,129,0.8); color: white; border: none; padding: 15px 25px; border-radius: 25px; font-size: 16px; cursor: pointer; backdrop-filter: blur(10px);">
                      üíæ Save
                    </button>
                  </div>
                </div>
                
                <!-- Close button -->
                <button id="close-preview-btn" style="position: absolute; top: 20px; right: 20px; background: rgba(0,0,0,0.7); color: white; border: none; padding: 15px; border-radius: 50%; font-size: 24px; cursor: pointer; backdrop-filter: blur(10px);">
                  ‚ùå
                </button>
              </div>
            `;
            
            // Add event listeners
            document.getElementById('retake-btn').addEventListener('click', () => {
              this.retakeComparisonPhoto(beforePhoto, originalStream);
            });
            
            document.getElementById('save-btn').addEventListener('click', () => {
              this.saveComparisonPhoto(afterPhotoDataUrl, beforePhoto);
            });
            
            document.getElementById('close-preview-btn').addEventListener('click', () => {
              document.body.removeChild(modal);
            });
          }
        }
        
        async retakeComparisonPhoto(beforePhoto, originalStream) {
          // Reopen camera for retaking
          const modal = document.querySelector('[style*="position: fixed"]');
          if (modal) {
            modal.innerHTML = `
              <div style="position: relative; width: 100vw; height: 100vh; display: flex; flex-direction: column;">
                <!-- Before photo (top half) -->
                <div style="position: relative; width: 100%; height: 50%; background: black;">
                  <img src="${beforePhoto.dataUrl}" style="width: 100%; height: 100%; object-fit: cover;" />
                  
                  <!-- Photo info overlay -->
                  <div style="position: absolute; bottom: 0; left: 0; right: 0; background: linear-gradient(transparent, rgba(0,0,0,0.8)); padding: 20px; text-align: center; color: white;">
                    <div style="font-size: 18px; font-weight: bold; margin-bottom: 5px;">
                      ${beforePhoto.room.charAt(0).toUpperCase() + beforePhoto.room.slice(1).replace('-', ' ')} - BEFORE
                    </div>
                    <div style="font-size: 14px; opacity: 0.9;">
                      ${new Date(beforePhoto.timestamp).toLocaleString()}
                    </div>
                  </div>
                </div>
                
                <!-- Camera (bottom half) -->
                <div id="camera-container" style="position: relative; width: 100%; height: 50%; background: black;">
                  <video id="comparison-camera" autoplay muted playsinline style="width: 100%; height: 100%; object-fit: cover;"></video>
                  
                  <!-- Photo frame overlay for camera -->
                  <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; pointer-events: none; display: flex; align-items: center; justify-content: center;">
                    <div style="width: 90%; height: 90%; border: 3px solid rgba(255,255,255,0.8); border-radius: 8px; box-shadow: 0 0 20px rgba(0,0,0,0.5);"></div>
                  </div>
                  
                  <!-- Camera controls -->
                  <div style="position: absolute; bottom: 20px; left: 0; right: 0; display: flex; justify-content: center; align-items: center; gap: 20px;">
                    <!-- Camera switch button -->
                    <button id="comparison-switch-camera-btn" style="background: rgba(0,0,0,0.6); color: white; border: none; padding: 12px; border-radius: 50%; font-size: 18px; cursor: pointer; backdrop-filter: blur(10px);">
                      üîÑ
                    </button>
                    
                    <!-- Capture button -->
                    <button id="comparison-capture-btn" style="background: #10b981; color: white; border: none; padding: 18px; border-radius: 50%; font-size: 22px; cursor: pointer; box-shadow: 0 4px 12px rgba(0,0,0,0.3);">
                      üì∏
                    </button>
                  </div>
                </div>
                
                <!-- Close button -->
                <button id="close-comparison-btn" style="position: absolute; top: 20px; right: 20px; background: rgba(0,0,0,0.7); color: white; border: none; padding: 15px; border-radius: 50%; font-size: 24px; cursor: pointer; backdrop-filter: blur(10px);">
                  ‚ùå
                </button>
              </div>
            `;
            
            // Initialize camera for retaking
            try {
              let stream;
              try {
                stream = await navigator.mediaDevices.getUserMedia({ 
                  video: { facingMode: 'environment' }
                });
              } catch (backCameraError) {
                stream = await navigator.mediaDevices.getUserMedia({ video: true });
              }
              
              const video = document.getElementById('comparison-camera');
              video.srcObject = stream;
              
              let currentFacingMode = 'environment';
              
              // Capture button
              document.getElementById('comparison-capture-btn').addEventListener('click', () => {
                this.captureComparisonPhoto(video, stream, beforePhoto);
              });
              
              // Camera switch button
              document.getElementById('comparison-switch-camera-btn').addEventListener('click', async () => {
                try {
                  stream.getTracks().forEach(track => track.stop());
                  currentFacingMode = currentFacingMode === 'user' ? 'environment' : 'user';
                  const newStream = await navigator.mediaDevices.getUserMedia({ 
                    video: { facingMode: currentFacingMode }
                  });
                  video.srcObject = newStream;
                  stream = newStream;
                } catch (error) {
                  console.log('Camera switch failed:', error);
                  alert('Camera switch failed: ' + error.message);
                }
              });
              
              // Close button
              document.getElementById('close-comparison-btn').addEventListener('click', () => {
                stream.getTracks().forEach(track => track.stop());
                document.body.removeChild(modal);
              });
              
            } catch (error) {
              alert('Camera access denied or failed: ' + error.message);
              document.body.removeChild(modal);
            }
          }
        }
        
        saveComparisonPhoto(afterPhotoDataUrl, beforePhoto) {
          // Show the split-screen combined photo preview
          this.showSplitScreenPreview(beforePhoto.dataUrl, afterPhotoDataUrl, beforePhoto.room);
        }
        
        showSplitScreenPreview(beforeDataUrl, afterDataUrl, room) {
          const modal = document.querySelector('[style*="position: fixed"]');
          if (modal) {
            modal.innerHTML = `
              <div style="position: relative; width: 100vw; height: 100vh; display: flex; flex-direction: column; background: white;">
                <!-- Before photo (top half) -->
                <div style="position: relative; width: 100%; height: 50%; background: black; overflow: hidden;">
                  <img src="${beforeDataUrl}" style="width: 100%; height: 100%; object-fit: cover;" />
                  <div style="position: absolute; top: 20px; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,0.8); color: white; padding: 8px 20px; border-radius: 20px; font-size: 18px; font-weight: bold;">
                    BEFORE
                  </div>
                </div>
                
                <!-- Divider line -->
                <div style="width: 100%; height: 4px; background: #000;"></div>
                
                <!-- After photo (bottom half) -->
                <div style="position: relative; width: 100%; height: 50%; background: black; overflow: hidden;">
                  <img src="${afterDataUrl}" style="width: 100%; height: 100%; object-fit: cover;" />
                  <div style="position: absolute; top: 20px; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,0.8); color: white; padding: 8px 20px; border-radius: 20px; font-size: 18px; font-weight: bold;">
                    AFTER
                  </div>
                </div>
                
                <!-- Action buttons overlay -->
                <div style="position: absolute; bottom: 20px; left: 0; right: 0; display: flex; justify-content: center; align-items: center; gap: 20px;">
                  <!-- Retake button -->
                  <button id="retake-split-btn" style="background: rgba(239,68,68,0.9); color: white; border: none; padding: 15px 25px; border-radius: 25px; font-size: 16px; cursor: pointer; backdrop-filter: blur(10px);">
                    üîÑ Retake After
                  </button>
                  
                  <!-- Save combined button -->
                  <button id="save-split-btn" style="background: rgba(16,185,129,0.9); color: white; border: none; padding: 15px 25px; border-radius: 25px; font-size: 16px; cursor: pointer; backdrop-filter: blur(10px);">
                    üíæ Save Combined Photo
                  </button>
                </div>
                
                <!-- Close button -->
                <button id="close-split-btn" style="position: absolute; top: 20px; right: 20px; background: rgba(0,0,0,0.7); color: white; border: none; padding: 15px; border-radius: 50%; font-size: 24px; cursor: pointer; backdrop-filter: blur(10px);">
                  ‚ùå
                </button>
              </div>
            `;
            
            // Add event listeners
            document.getElementById('retake-split-btn').addEventListener('click', () => {
              this.retakeComparisonPhoto({dataUrl: beforeDataUrl, room: room}, null);
            });
            
            document.getElementById('save-split-btn').addEventListener('click', () => {
              this.captureSplitScreenPhoto(beforeDataUrl, afterDataUrl, room);
            });
            
            document.getElementById('close-split-btn').addEventListener('click', () => {
              document.body.removeChild(modal);
            });
          }
        }
        
        captureSplitScreenPhoto(beforeDataUrl, afterDataUrl, room) {
          // Create a temporary fullscreen container for the split-screen photo
          const tempContainer = document.createElement('div');
          tempContainer.style.cssText = `
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; 
            background: white; z-index: 9999;
          `;
          
          tempContainer.innerHTML = `
            <div style="position: relative; width: 100%; height: 100%; display: flex; flex-direction: column;">
              <!-- Before photo (top half) -->
              <div style="position: relative; width: 100%; height: 50%; background: black; overflow: hidden;">
                <img src="${beforeDataUrl}" style="width: 100%; height: 100%; object-fit: cover;" />
                <div style="position: absolute; top: 20px; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,0.8); color: white; padding: 8px 20px; border-radius: 20px; font-size: 18px; font-weight: bold;">
                  BEFORE
                </div>
              </div>
              
              <!-- Divider line -->
              <div style="width: 100%; height: 4px; background: #000;"></div>
              
              <!-- After photo (bottom half) -->
              <div style="position: relative; width: 100%; height: 50%; background: black; overflow: hidden;">
                <img src="${afterDataUrl}" style="width: 100%; height: 100%; object-fit: cover;" />
                <div style="position: absolute; top: 20px; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,0.8); color: white; padding: 8px 20px; border-radius: 20px; font-size: 18px; font-weight: bold;">
                  AFTER
                </div>
              </div>
            </div>
          `;
          
          document.body.appendChild(tempContainer);
          
          // Use html2canvas to capture the entire screen
          setTimeout(() => {
            this.captureScreenAsImage(tempContainer, room);
          }, 500); // Give time for images to load
        }
        
        captureScreenAsImage(container, room) {
          // Create a canvas to capture the screen
          const canvas = document.createElement('canvas');
          const ctx = canvas.getContext('2d');
          
          // Set canvas size to match the container
          canvas.width = container.offsetWidth;
          canvas.height = container.offsetHeight;
          
          // Fill white background
          ctx.fillStyle = '#ffffff';
          ctx.fillRect(0, 0, canvas.width, canvas.height);
          
          // Get all images from the container
          const images = container.querySelectorAll('img');
          let imagesLoaded = 0;
          const totalImages = images.length;
          
          if (totalImages === 0) {
            // No images, just save the container
            this.saveCombinedPhoto(canvas.toDataURL('image/jpeg', 0.9), room);
            document.body.removeChild(container);
            return;
          }
          
          const onImageLoad = () => {
            imagesLoaded++;
            if (imagesLoaded === totalImages) {
              // All images loaded, now draw them
              const halfHeight = canvas.height / 2;
              
              // Draw before photo (top half)
              const beforeImg = images[0];
              ctx.drawImage(beforeImg, 0, 0, canvas.width, halfHeight);
              
              // Draw divider line
              ctx.strokeStyle = '#000000';
              ctx.lineWidth = 4;
              ctx.beginPath();
              ctx.moveTo(0, halfHeight);
              ctx.lineTo(canvas.width, halfHeight);
              ctx.stroke();
              
              // Draw after photo (bottom half)
              const afterImg = images[1];
              ctx.drawImage(afterImg, 0, halfHeight, canvas.width, halfHeight);
              
              // Add labels
              ctx.fillStyle = 'rgba(0,0,0,0.8)';
              ctx.font = 'bold 18px Arial';
              ctx.textAlign = 'center';
              
              // Before label
              ctx.fillRect(canvas.width/2 - 50, 20, 100, 30);
              ctx.fillStyle = '#ffffff';
              ctx.fillText('BEFORE', canvas.width/2, 40);
              
              // After label
              ctx.fillStyle = 'rgba(0,0,0,0.8)';
              ctx.fillRect(canvas.width/2 - 50, halfHeight + 20, 100, 30);
              ctx.fillStyle = '#ffffff';
              ctx.fillText('AFTER', canvas.width/2, halfHeight + 40);
              
              // Convert to data URL and save
              const combinedDataUrl = canvas.toDataURL('image/jpeg', 0.9);
              this.saveCombinedPhoto(combinedDataUrl, room);
              
              // Clean up
              document.body.removeChild(container);
            }
          };
          
          // Set up image load handlers
          images.forEach(img => {
            if (img.complete) {
              onImageLoad();
            } else {
              img.onload = onImageLoad;
            }
          });
        }
        
        saveCombinedPhoto(combinedDataUrl, room) {
          // Find the before and after photos for this room
          const roomPhotos = this.photos.filter(photo => photo.room === room);
          const beforePhoto = roomPhotos.find(photo => photo.mode === 'before');
          const afterPhoto = roomPhotos.find(photo => photo.mode === 'after');
          
          // Create meaningful name for the combined photo
          const roomName = room.charAt(0).toUpperCase() + room.slice(1).replace('-', ' ');
          const combinedPhotoName = `${roomName}_Combined_${new Date().toISOString().slice(0, 19).replace(/:/g, '-')}`;
          
          // Create the combined photo
          const combinedPhoto = {
            id: Date.now(),
            dataUrl: combinedDataUrl,
            room: room,
            mode: 'mix',
            name: combinedPhotoName,
            timestamp: Date.now()
          };
          
          // Add the combined photo
          this.photos.push(combinedPhoto);
          
          // Move before and after photos to "archived" mode (All tab)
          if (beforePhoto) {
            beforePhoto.mode = 'archived';
          }
          if (afterPhoto) {
            afterPhoto.mode = 'archived';
          }
          
          this.savePhotos();
          
          // Close the modal and refresh
          document.body.removeChild(document.querySelector('[style*="position: fixed"]'));
          this.init();
          
          // Photo saved successfully - no popup needed
        }
        
        async openCamera() {
          try {
            if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
              alert('Camera not supported on this device');
              return;
            }
            
            // Try to use back camera first, fallback to any camera
            let stream;
            try {
              stream = await navigator.mediaDevices.getUserMedia({ 
                video: { facingMode: 'environment' } // Back camera
              });
            } catch (backCameraError) {
              console.log('Back camera not available, trying any camera:', backCameraError);
              stream = await navigator.mediaDevices.getUserMedia({ video: true });
            }
            
            // Create fullscreen camera modal
            const modal = document.createElement('div');
            modal.style.cssText = `
              position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; 
              background: black; z-index: 1000; display: flex; 
              flex-direction: column; align-items: center; justify-content: center;
            `;
            
            modal.innerHTML = `
              <!-- Split-screen camera - top half active -->
              <div style="position: relative; width: 100vw; height: 100vh; display: flex; flex-direction: column;">
                <!-- Top half - Active camera -->
                <div style="position: relative; width: 100%; height: 50%; background: black;">
                  <video id="camera-video" autoplay muted playsinline style="width: 100%; height: 100%; object-fit: cover;"></video>
                  
                  <!-- Photo frame overlay for camera -->
                  <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; pointer-events: none; display: flex; align-items: center; justify-content: center;">
                    <div style="width: 90%; height: 90%; border: 3px solid rgba(255,255,255,0.8); border-radius: 8px; box-shadow: 0 0 20px rgba(0,0,0,0.5);"></div>
                  </div>
                  
                  <!-- Camera controls on top half -->
                  <div style="position: absolute; bottom: 20px; left: 0; right: 0; display: flex; justify-content: center; align-items: center; gap: 20px;">
                    <!-- Camera switch button -->
                    <button id="switch-camera-btn" style="background: rgba(0,0,0,0.6); color: white; border: none; padding: 12px; border-radius: 50%; font-size: 18px; cursor: pointer; backdrop-filter: blur(10px);">
                      üîÑ
                    </button>
                    
                    <!-- Capture button -->
                    <button id="capture-btn" style="background: #10b981; color: white; border: none; padding: 18px; border-radius: 50%; font-size: 22px; cursor: pointer; box-shadow: 0 4px 12px rgba(0,0,0,0.3);">
                      üì∏
                    </button>
                  </div>
                </div>
                
                <!-- Divider line -->
                <div style="width: 100%; height: 4px; background: #000;"></div>
                
                <!-- Bottom half - Reference or inactive -->
                <div style="position: relative; width: 100%; height: 50%; background: #f8f9fa; display: flex; align-items: center; justify-content: center;">
                  <div style="text-align: center; color: #64748b;">
                    <div style="font-size: 24px; margin-bottom: 10px;">üì∑</div>
                    <div style="font-size: 16px; font-weight: bold;">Camera Active</div>
                    <div style="font-size: 14px; margin-top: 5px;">Take your photo using the controls above</div>
                  </div>
                </div>
                
                <!-- Close button -->
                <button id="close-camera-btn" style="position: absolute; top: 20px; right: 20px; background: rgba(0,0,0,0.7); color: white; border: none; padding: 15px; border-radius: 50%; font-size: 24px; cursor: pointer; backdrop-filter: blur(10px);">
                  ‚ùå
                </button>
              </div>
            `;
            
            document.body.appendChild(modal);
            
            const video = document.getElementById('camera-video');
            video.srcObject = stream;
            
            // Store current facing mode
            let currentFacingMode = 'environment'; // Start with back camera
            
            document.getElementById('capture-btn').addEventListener('click', () => {
              this.capturePhoto(video, stream);
            });
            
            document.getElementById('switch-camera-btn').addEventListener('click', async () => {
              try {
                // Stop current stream
                stream.getTracks().forEach(track => track.stop());
                
                // Switch facing mode
                currentFacingMode = currentFacingMode === 'user' ? 'environment' : 'user';
                
                // Get new stream with switched camera
                const newStream = await navigator.mediaDevices.getUserMedia({ 
                  video: { facingMode: currentFacingMode }
                });
                
                // Update video source
                video.srcObject = newStream;
                
                // Update the stream reference for capture
                stream = newStream;
                
                console.log('Switched to', currentFacingMode === 'user' ? 'front' : 'back', 'camera');
              } catch (error) {
                console.log('Camera switch failed:', error);
                alert('Camera switch failed: ' + error.message);
              }
            });
            
            
            document.getElementById('close-camera-btn').addEventListener('click', () => {
              stream.getTracks().forEach(track => track.stop());
              document.body.removeChild(modal);
            });
            
          } catch (error) {
            alert('Camera access denied or failed: ' + error.message);
          }
        }
        
        capturePhoto(video, stream) {
          const canvas = document.createElement('canvas');
          const context = canvas.getContext('2d');
          
          canvas.width = video.videoWidth;
          canvas.height = video.videoHeight;
          
          context.drawImage(video, 0, 0);
          
          // Determine photo mode based on existing photos for this room
          const roomPhotos = this.photos.filter(photo => photo.room === this.currentRoom);
          const hasBeforePhoto = roomPhotos.some(photo => photo.mode === 'before');
          const hasAfterPhoto = roomPhotos.some(photo => photo.mode === 'after');
          
          let photoMode;
          if (!hasBeforePhoto) {
            photoMode = 'before';
          } else if (!hasAfterPhoto) {
            photoMode = 'after';
          } else {
            // Both photos exist, this will be a new "before" photo (replacing the old one)
            photoMode = 'before';
          }
          
          // Create meaningful name for the photo
          const roomName = this.currentRoom.charAt(0).toUpperCase() + this.currentRoom.slice(1).replace('-', ' ');
          const photoName = `${roomName}_${photoMode}_${new Date().toISOString().slice(0, 19).replace(/:/g, '-')}`;
          
          const photo = {
            id: Date.now(),
            dataUrl: canvas.toDataURL('image/jpeg', 0.8),
            room: this.currentRoom,
            mode: photoMode,
            name: photoName,
            timestamp: Date.now()
          };
          
          this.photos.push(photo);
          this.savePhotos();
          
          // Close camera
          stream.getTracks().forEach(track => track.stop());
          document.body.removeChild(document.querySelector('[style*="position: fixed"]'));
          
          // Refresh display
          this.init();
        }
        
        savePhotos() {
          localStorage.setItem('cleaning-photos', JSON.stringify(this.photos));
        }
        
        loadPhotos() {
          const saved = localStorage.getItem('cleaning-photos');
          if (saved) {
            this.photos = JSON.parse(saved);
          }
        }
      }
      
      // Initialize app
      new CleaningPhotoApp();
      console.log('‚úÖ Debug: iOS Safari compatible app loaded successfully');
    </script>
    
    <!-- Fallback for browsers that don't support ES6 modules -->
    <script nomodule>
      console.log('‚ùå Debug: ES6 modules not supported, using fallback');
      document.getElementById('debug-info').innerHTML += '<div style="color: orange;">‚ö†Ô∏è ES6 modules not supported</div>';
      
      // Show a simple message instead of React app
      setTimeout(() => {
        document.getElementById('root').innerHTML = `
          <div style="padding: 20px; text-align: center; font-family: Arial, sans-serif;">
            <h1>üö´ Browser Compatibility Issue</h1>
            <p>Your browser doesn't support ES6 modules, which are required for this app.</p>
            <p>Please update your browser or try a different browser.</p>
            <p style="color: #666; font-size: 14px;">iOS Safari 10.3+ is required for ES6 module support.</p>
          </div>
        `;
      }, 2000);
    </script>
    
    <script>
      // This will run after main.jsx loads (if it loads)
      console.log('‚úÖ Debug: main.jsx script tag processed');
    </script>
  </body>
</html>